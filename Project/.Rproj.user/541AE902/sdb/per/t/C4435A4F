{
    "collab_server" : "",
    "contents" : "# Data Understanding\n\nGoing forward with the anaylisis, the goal in the second step is to have a first perception of the information brought by the data and create hypotheses about them. To be able to do so, we will develop the following points:\n\n## Collect initial data\n\nThe dataset was delivered together with the description of the task and is in *csv format*. It contains 1'000 observations, 1 each row, 30 input variables and 1 output variable. \nIn addition to the dataset, we seek for more information in videos in youtube where we were mainly intended to familiarize with the operation by itself and, hence, indeep more into the variables that we consider that bring more information. \n\n\n## Describe data\n\nIn this point, we will examine the gross properties of the adquire data. Let's start checking the stucture and size of it. As you can see below, there are 1'000 rows and 32 variables. The first column identifies all the observations taken into consideration with an unique ID (a number), the 30 following columns are the input variables, while the last one is the output variable, which gives the information regarding the person is a high risk (the credit is rejected) or not (the credit is accepted).\n\n```{r, echo=TRUE, message=FALSE, warning=FALSE}\n\ndim(data)\n\n```\n\nNow, let's give a look to the summary and the structe of the data, including their \nstatistical characteristics, for example, minimum, mean, maximum, so on. \n\n### {.tabset .tabset-fade .tabset-pills}\n\nOverview of the dataset (1000 observations):  \n\n#### Summary\n<!-- I cannot use this one  -->\n```{r , echo=FALSE, message=FALSE, warning=FALSE}\n\n#summarydata<- dfSummary(data, plain.ascii = FALSE, \n#                        style = 'grid', graph.magnif = 0.75,\n#                        valid.col = FALSE, tmp.img.dir = \"/tmp\")\n\n\n# summarydata<- print(dfSummary(data, valid.col = FALSE, \n                              # graph.magnif = 0.75),       \n                              # max.tbl.height = 300, method = \"render\")\n\n# summarydata\n\n```\n\n#### Output variable: yes / no\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\n\ndata %>% \n  ggplot(aes(x = RESPONSE)) + \n  geom_bar(aes(fill = factor(RESPONSE))) + \n  labs(color = \"\", fill = \"\", x = \"RESPONSE\", y = \"count\", \n       title = \"Output Variable\") + \n    geom_label(stat = 'count', aes(label =..count..)) +\n  theme_bw()\n\n```\n\nAs we can see from the graph, there is the majority of the observations which have a positive value (700 against 300).\n\n#### Description by output variable\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\n\npsych::describeBy(data, data$RESPONSE)\n\n```\n\n### \n\nAs we see in the table shown earlier, all the values are integers and there is not any missing value. In addition, we can see some inconsistencies of the variables with the initial description, that we will explain in following.\n\n| Variable   | Description   | Inconsistencies   |\n| :---------:|:--------------|:-------|\n| CHK_ACCT   |  C: 0, 1, 2, 3    | X  |\n| DURATION |  Numerical    | X  |\n| HISTORY |  C: 0, 1, 2, 3, 4 | X  |\n| NEW_CAR  |  B: 0, 1  | X  |\n| USED_CAR |  B: 0, 1\t  | X  |\n| FURNITURE |  B: 0, 1    | X  |\n| RADIO.TV  |  B: 0, 1   | X  |\n| EDUCATION |  B: 0, 1   | ✔: Acoording to the description we should have a binary variable and the data show -1 |\n| RETRAINING  |  B: 0, 1| X  |\n| AMOUNT      |  Numerical | X  |\n| SAV_ACCT    |  C: 0, 1, 2, 3, 4 | X  |\n| EMPLOYMENT  |  C: 0, 1, 2, 3, 4 | X  |\n| INSTALL_RATE |  Numerical| X  |\n| MALE_DIV |  B: 0, 1 | X  |\n| MALE_SINGLE\t|  B: 0, 1 | X  |\n| MALE_MAR_WID |  B: 0, 1 | X  |\n| CO-APPLICANT |  B: 0, 1 | X  |\n| GUARANTOR   |  B: 0, 1 |  ✔: Acoording to the description we should have a binary variable and the data show a 2 |\n| PRESENT_RESIDENT|  C: 0, 1, 2, 3| ✔: Acoording to the description we should 3 categories instead of 4 shown by the data|\n| REAL_ESTATE |  B: 0, 1| X  |\n| PROP_UNKN_NONE  |  B: 0, 1| X  |\n| AGE|  Numerical| ✔: Identify outliers, the age should not go up to 125 years |\n| OTHER_INSTALL|  B: 0, 1| X  |\n| RENT |  B: 0, 1| X  |\n| OWN_RES |  B: 0, 1| X  |\n| NUM_CREDITS|  Numerical| X  |\n| JOB |  C: 0, 1, 2, 3| X  |\n| NUM_DEPENDENTS  |  Numerical| X  |\n| TELEPHONE  |  B: 0, 1| X  |\n| FOREIGN    |  B: 0, 1| X  |\n\nThen, for the 3 inconsistencies found before, We have established the following hypothesis and solutions.\n\n- EDUCATION: there was an error in the registration of the information and the -1 must be replaced by 1.\n- GUARANTOR: there was an error in the registration of the information and the 2 must be replaced by 1.\n- PRESENT_RESIDENT: Again, there was an error in the registration of the information and the register was made in years instead of the category.\n- AGE: Here it is clear that we have some outliers, we should limit the age to 75.\n\nThe corrections will be made in the next section.\n\nIt is also important to mention that the output variable shows in 70% that the credit is accepted and in 30% rejected, which can later bias the prediction.\n\n## Explore data\n\nIn this section, we will go deeper into the data and look for patterns or relationships between variables. To be able to do it, we will develop an histogram to check the distribution of our data for each variable.\n\n### {.tabset .tabset-fade .tabset-pills}\n\nOverview of the dataset without any modification.\nNote: a detailed description of each variable can be found in the appendix.\n\n#### Histogram\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, fig.asp=2}\n\nx<-inspect_num(data[,-32])\nshow_plot(x, text_labels = TRUE, \n          alpha = 0.05, high_cardinality = 0,\n          plot_layout = NULL,  col_palette=3, \n          plot_type = \"bar\", label_thresh = 0.1) + theme_bw()\n\n```\n\n#### Histogram by answer\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, fig.asp=4}\n\ndata[,-1] %>% \n  explore_all(target = RESPONSE) + theme_bw()\n\n```\n\n### \n\nRegarding the last charts, we have the following observations:\n\n- We can see that the numerical variable have a normal distribution asymmetric to the right (Skewed (Non-Normal) Right), possibly because we have a more significant lower bound.\n- It is very difficult to indentify patterns in the data.\n- In the second one, histograms by response variable, we are able to see the proportion within the positives and negatives answers applications. \n\n### {.tabset .tabset-fade .tabset-pills}\n\nConsider that the graphs are an overview of the dataset without any modification.\n\n#### Boxplot\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE}\n\npar(mfrow=c(3,3))\nfor (i in 1:length(data)) {\n        boxplot(data[,i], horizontal = TRUE, pars=list(outcol=\"red\"), \n                main=names(data[i]), type=\"l\")}\n\n```\n\n#### Boxplot by output\n\n```{r, echo=FALSE , message=FALSE, warning=FALSE}\n\nplot_boxplot(data[,c(-1)], by= 'RESPONSE',  \n             ncol = 2,  ggtheme =theme_bw(), \n             title = \"Side-by-side boxplots\",\n             geom_boxplot_args = list(\"outlier.color\" = \"red\"))\n\n```\n\n### \n\nIn the following table, you will find our principal observations. \n\n| Boxplot          | Observation       |\n| :---------------:|:------------------|\n| For each variable | We indentify that some variable could be mutually exclusive between them. We can evaluate the formation of the following groups: <br /> 1) Agregation of the varibles purpose of the credit <br /> 2) Agregation of the male variables as a categorical one. <br /> 3) Agregation of the REAL_ESTATE and PROP_UNKN_NONE as a categorical one. <br /> 4) Agregation of the RENT and OWN_RES as a categorical one. |\n| plot by response | The variables which stand out more are: CHK_ACCT and EMPLOYMENT. We can observe that each box by group are different between each other. | \n\nAdditionally, we could identify some outliers, show as red dots and, as you can see in the second chart, the input variables clustered by the output variable show that there are some features that bring more information than others.   \n\n**key definitions:** \n\n1) *Real property includes the physical property (physical land, structures and resources attached to it) of the real estate, but it expands its definition to include other types of ownerships as rights. Meaning that we can have properties without real state (PROP_UNKN_NONE =0 & REAL_ESTATE=0)*\n2) *For the RENT and OWN_RES variable, we can see that we have 3 cases: 1-0, 0-1 and 0-0 because there exists the possibility that the person who apply for the loan do not owns the residence and neither is in charge of any rent.*\n\n### {.tabset .tabset-fade .tabset-pills}\n\nNow, we will give a look to the importance of each variable by evaluating 2 points:\n\n- Multicollinearity\n- Correlation\n\n#### Multicollinearity\n\n```{r, echo=FALSE, , message=FALSE, warning=FALSE}\n\n# Build the model\nmodel1 <- lm(RESPONSE ~., data = data)\ncar::vif(model1)\n\n```\n\n#### Correlation\n\n```{r, echo=FALSE, fig.asp=1.2, message=FALSE, warning=FALSE}\n\nplot_correlation(data, type= 'c', \n                 cor_args = list( 'use' = 'complete.obs'))        \n\n```\n\n### \n\nOur observations about the chart shown above can be found in the following table: \n\n\n| Anylisis          | Observation       |\n| :----------------:|:------------------|\n| Multicollinearity | There is one variable which VIF is higher from 5: OWN_RES | \n| Correlation       | This correlation graph proof what was found in the Multicollinearity analysis. |\n\nIn general, the VIF is not high enough to eliminate the variable. \n\n## Verify data quality\n\nTo be able to do so, we establish 3 questions that we will address during the resolution of this step:\n\n1) Is the data complete (does it cover all the cases required)? \n2) Is it correct or does it contain any error?\n3) Are there missing values in the data? If so how are they represented?\n\n### {.tabset .tabset-fade .tabset-pills}\n\n\n#### Description dataset\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE}\n\nintroduce(data[,-32])\nplot_intro(data[,-32], title =\"XXXX\", \n           ggtheme =theme_bw(), \n           theme_config=theme(legend.position=\"bottom\"))\n\n\n```\n\n#### Missing Values\n\n```{r, echo=FALSE, fig.asp=1.2, message=FALSE, warning=FALSE}\n\nnrows<-nrow(data)\nn.missing<-rowSums(is.na(data))\nsum(n.missing > 0)/nrows\nn.complete<-sum(complete.cases(data))\nn.complete/nrows\n\na<- plot_missing(data[,-32], title =\"XXXX\", \n           ggtheme =theme_bw(), \n           theme_config=theme(legend.position=\"bottom\"))\n\n#Inspect the NA values\n\n#inspect_na(data[,-32])\ninspect_types(data[,-32])\n\n#delete variables\nrm(a,model1, x, i, n.complete, n.missing, nrows)\n\n```\n\n### \n\nBelow you will find the answers of the 3 questions:\n\n| Question    | Answer       | \n| :----------:|:--------------|\n| 1           | Yes, all the columns and rows contains information. | \n| 2           | No, they contain some errors. They were found in data description and exploratory and are the following: <br /> 1) The variable Education shows an output that is not binary. <br /> 2) The variable PRESENT_RESIDENT have more categories than those that were mentioned in the description <br /> 3) the variable AGE is out of range. <br /> 4) AMOUNT, DURANTION, AGE are the variables with the highest quantity of outliers. | \n| 3           | No, there is not any missing values in the data. | \n\nIn addition, we are going to anaylise if the agregation mentioned in the boxplot for each variable is possible, to be able to do so, we are going to apply the **Chi-Square Test** to measure the independence between them. Next, we are going to explain the steps taking for each analysis: \n\n**1) Variables: REAL_ESTATE and PROP_UNKN_NONE**\n\nFirst, we establish the hypotheses:\n\nH0: The `REAL_ESTATE` and `PROP_UNKN_NONE` are independent variables.\n\nagainst the bilateral alternative: \n\nH1: They are not independent.\n\nFor the chi-squared test to be valid, the following conditions must be true:\n\n1) The sampling method is random\n2) The variables considered are categorical\n3) Size: all levels have more than 5 expected events.\n\n*Assuptions*: Significance level of **0.05**\n*Clarifications*: The p-value is the probability that a chi-square statistic having X degrees of freedom is more extreme than $X^2$. \n\nFinally, we are going to accept or reject the hypotheses checking the p-value. If the p-value is less than the significance level that we have established earlier we reject the null hypothesis. Thus, we conclude that there is a relationship between the variables.\n\n**2) RENT and OWN_RES**\n\nFirst, we stablish the hypotheses:\n\nH0: The `RENT` and `OWN_RES` are independent variables.\n\nagainst the bilateral alternative: \n\nH1: They are not independent.\n\nThen we move on with the same process that we mentioned above.\n\nThe analysis can be found in the next chapter.",
    "created" : 1605717849823.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2896224535",
    "id" : "C4435A4F",
    "lastKnownWriteTime" : 1606995941,
    "last_content_update" : 1606995941585,
    "path" : "~/Desktop/-/Uni/Third Semester/Projects in Data Analytics for Decision Making/Project/Projects-DA-DecisionMaking/Project/report/eda-I.Rmd",
    "project_path" : "report/eda-I.Rmd",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}